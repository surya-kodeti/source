
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://surya-kodeti.github.io/source/opencv_docs/opencv/doc/tutorials/dnn/dnn_custom_layers/dnn_custom_layers/">
      
      
        <link rel="prev" href="../../../../opencv-logo/">
      
      
        <link rel="next" href="../../dnn_pytorch_tf_classification/pytorch_cls_model_conversion_c_tutorial/">
      
      
      <link rel="icon" href="../../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Custom deep learning layers support {#tutorial_dnn_custom_layers} - Documentation Portal</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../../styles/custom.css">
    
    <script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="white">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#custom-deep-learning-layers-support-tutorial_dnn_custom_layers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../../.." title="Documentation Portal" class="md-header__button md-logo" aria-label="Documentation Portal" data-md-component="logo">
      
  <img src="../../../../../../../images/amex.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation Portal
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Custom deep learning layers support {#tutorial_dnn_custom_layers}
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../../.." title="Documentation Portal" class="md-nav__button md-logo" aria-label="Documentation Portal" data-md-component="logo">
      
  <img src="../../../../../../../images/amex.png" alt="logo">

    </a>
    Documentation Portal
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Create shared react context docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Create shared react context docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Create shared react context
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Create shared react context
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../create-shared-react-context_docs/create-shared-react-context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../create-shared-react-context_docs/create-shared-react-context/CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CHANGELOG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../create-shared-react-context_docs/create-shared-react-context/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CODE OF CONDUCT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../create-shared-react-context_docs/create-shared-react-context/CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing to create-shared-react-context
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../create-shared-react-context_docs/create-shared-react-context/SECURITY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SECURITY
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docsify docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Docsify docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docsify
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Docsify
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.13.0 (2022-10-26)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/HISTORY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HISTORY
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/SECURITY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6" >
        
          
          <label class="md-nav__link" for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_6">
            <span class="md-nav__icon md-icon"></span>
            Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docsify
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/_coverpage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     coverpage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/_navbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     navbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/_sidebar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     sidebar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/adding-pages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding pages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/cdn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CDN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/cover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/custom-navbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom navbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/embed-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Embed files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/emoji/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Emoji
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/helpers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Doc helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/language-highlight/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language highlighting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List of Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/pwa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Offline Mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/themes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Themes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/ui-kit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ui kit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/vue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vue compatibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/write-a-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Write a plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6_23" >
        
          
          <label class="md-nav__link" for="__nav_3_1_6_23" id="__nav_3_1_6_23_label" tabindex="0">
            
  
  <span class="md-ellipsis">
     media
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_6_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_6_23">
            <span class="md-nav__icon md-icon"></span>
             media
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/_media/example-with-yaml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example with yaml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/docs/_media/example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_7" >
        
          
          <label class="md-nav__link" for="__nav_3_1_7" id="__nav_3_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_7">
            <span class="md-nav__icon md-icon"></span>
            Test
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../docsify_docs/docsify/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docsify Testing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Opencv docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Opencv docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Opencv
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Opencv
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CONTRIBUTING
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../SECURITY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3rdparty
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            3rdparty
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_1" id="__nav_4_1_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Carotene
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            Carotene
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/carotene/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_2" id="__nav_4_1_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cpufeatures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_2">
            <span class="md-nav__icon md-icon"></span>
            Cpufeatures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/cpufeatures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_3" id="__nav_4_1_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flatbuffers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            Flatbuffers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/flatbuffers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_4" id="__nav_4_1_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libjpeg turbo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_4">
            <span class="md-nav__icon md-icon"></span>
            Libjpeg turbo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/libjpeg-turbo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Background
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/libjpeg-turbo/LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    libjpeg-turbo Licenses
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_5" id="__nav_4_1_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libtiff
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_5">
            <span class="md-nav__icon md-icon"></span>
            Libtiff
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/libtiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_6" id="__nav_4_1_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Openjpeg
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_6">
            <span class="md-nav__icon md-icon"></span>
            Openjpeg
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/openjpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OPENJPEG Library and Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/openjpeg/AUTHORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors of OpenJPEG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/openjpeg/CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/openjpeg/THANKS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenJPEG THANKS file
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_7" id="__nav_4_1_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Openvx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_7">
            <span class="md-nav__icon md-icon"></span>
            Openvx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/openvx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ wrappers for OpenVX-1.x C API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_7_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_7_2" id="__nav_4_1_4_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_4_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_7_2">
            <span class="md-nav__icon md-icon"></span>
            Hal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/openvx/hal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenVX-based HAL implementation.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_8" id="__nav_4_1_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protobuf
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_8">
            <span class="md-nav__icon md-icon"></span>
            Protobuf
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/protobuf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_9" id="__nav_4_1_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Zlib ng
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_9">
            <span class="md-nav__icon md-icon"></span>
            Zlib ng
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/zlib-ng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/zlib-ng/LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LICENSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_9_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_9_3" id="__nav_4_1_4_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Arch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_4_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_9_3">
            <span class="md-nav__icon md-icon"></span>
            Arch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_9_3_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_9_3_1" id="__nav_4_1_4_9_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Riscv
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_4_9_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_9_3_1">
            <span class="md-nav__icon md-icon"></span>
            Riscv
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/zlib-ng/arch/riscv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building RISC-V Target with Cmake
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4_9_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4_9_3_2" id="__nav_4_1_4_9_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    S390
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_4_9_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4_9_3_2">
            <span class="md-nav__icon md-icon"></span>
            S390
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../3rdparty/zlib-ng/arch/s390/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            Apps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_5_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_5_1" id="__nav_4_1_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Opencv stitching tool
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_5_1">
            <span class="md-nav__icon md-icon"></span>
            Opencv stitching tool
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../apps/opencv_stitching_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Doc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_6">
            <span class="md-nav__icon md-icon"></span>
            Doc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opencv-logo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Opencv logo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2" id="__nav_4_1_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_6_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_6_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_1" id="__nav_4_1_6_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_6_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_6_2_1">
            <span class="md-nav__icon md-icon"></span>
            Dnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_1_1" id="__nav_4_1_6_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn custom layers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_6_2_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_6_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            Dnn custom layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Custom deep learning layers support {#tutorial_dnn_custom_layers}
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Custom deep learning layers support {#tutorial_dnn_custom_layers}
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-a-custom-layer-in-c" class="md-nav__link">
    <span class="md-ellipsis">
      Define a custom layer in C++
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-custom-layer-from-caffe" class="md-nav__link">
    <span class="md-ellipsis">
      Example: custom layer from Caffe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-custom-layer-from-tensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      Example: custom layer from TensorFlow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-a-custom-layer-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Define a custom layer in Python
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_1_2" id="__nav_4_1_6_2_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn pytorch tf classification
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_6_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            Dnn pytorch tf classification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dnn_pytorch_tf_classification/pytorch_cls_model_conversion_c_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion of PyTorch Classification Models and Launch with OpenCV C++ {#pytorch_cls_c_tutorial_dnn_conversion}
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dnn_pytorch_tf_classification/pytorch_cls_model_conversion_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion of PyTorch Classification Models and Launch with OpenCV Python {#pytorch_cls_tutorial_dnn_conversion}
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dnn_pytorch_tf_classification/tf_cls_model_conversion_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion of TensorFlow Classification Models and Launch with OpenCV Python {#tf_cls_tutorial_dnn_conversion}
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_1_3" id="__nav_4_1_6_2_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn pytorch tf detection
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_6_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            Dnn pytorch tf detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dnn_pytorch_tf_detection/tf_det_model_conversion_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion of TensorFlow Detection Models and Launch with OpenCV Python {#tf_det_tutorial_dnn_conversion}
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_1_4" id="__nav_4_1_6_2_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn pytorch tf segmentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_6_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            Dnn pytorch tf segmentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dnn_pytorch_tf_segmentation/pytorch_sem_segm_model_conversion_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion of PyTorch Segmentation Models and Launch with OpenCV {#pytorch_segm_tutorial_dnn_conversion}
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dnn_pytorch_tf_segmentation/tf_sem_segm_model_conversion_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion of TensorFlow Segmentation Models and Launch with OpenCV {#tf_segm_tutorial_dnn_conversion}
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_2" id="__nav_4_1_6_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Imgproc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_6_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6_2_2">
            <span class="md-nav__icon md-icon"></span>
            Imgproc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6_2_2_1" id="__nav_4_1_6_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Morph lines detection
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_6_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Morph lines detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../imgproc/morph_lines_detection/morph_lines_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract horizontal and vertical lines by using morphological operations {#tutorial_morph_lines_detection}
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_1" id="__nav_4_1_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_1">
            <span class="md-nav__icon md-icon"></span>
            Dnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_1_1" id="__nav_4_1_7_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Src
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_7_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_1_1">
            <span class="md-nav__icon md-icon"></span>
            Src
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_1_1_1" id="__nav_4_1_7_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Webnn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_7_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Webnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/dnn/src/webnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2" id="__nav_4_1_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gapi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2">
            <span class="md-nav__icon md-icon"></span>
            Gapi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2_1" id="__nav_4_1_7_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Doc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_7_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2_1">
            <span class="md-nav__icon md-icon"></span>
            Doc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/gapi/doc/10-hld-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-level design overview {#gapi_hld}
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2_1_2" id="__nav_4_1_7_2_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Slides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_7_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            Slides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/gapi/doc/slides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    G-API Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2_2" id="__nav_4_1_7_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Src
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_7_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2_2">
            <span class="md-nav__icon md-icon"></span>
            Src
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2_2_1" id="__nav_4_1_7_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Api
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_7_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/gapi/src/api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2_2_2" id="__nav_4_1_7_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backends
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_7_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/gapi/src/backends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_2_2_3" id="__nav_4_1_7_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Compiler
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_7_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Compiler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/gapi/src/compiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_3" id="__nav_4_1_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Js
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_3">
            <span class="md-nav__icon md-icon"></span>
            Js
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_3_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_3_1" id="__nav_4_1_7_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Perf
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_7_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_3_1">
            <span class="md-nav__icon md-icon"></span>
            Perf
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/js/perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenCV.js Performance Test
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_4" id="__nav_4_1_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Objc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_4">
            <span class="md-nav__icon md-icon"></span>
            Objc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7_4_1" id="__nav_4_1_7_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Doc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_7_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7_4_1">
            <span class="md-nav__icon md-icon"></span>
            Doc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../modules/objc/doc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8" id="__nav_4_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Platforms
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8">
            <span class="md-nav__icon md-icon"></span>
            Platforms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8_1" id="__nav_4_1_8_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Android
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8_1">
            <span class="md-nav__icon md-icon"></span>
            Android
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8_1_1" id="__nav_4_1_8_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Aar template
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_8_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8_1_1">
            <span class="md-nav__icon md-icon"></span>
            Aar template
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/android/aar-template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8_2" id="__nav_4_1_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apple
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8_2">
            <span class="md-nav__icon md-icon"></span>
            Apple
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/apple/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building for Apple Platforms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8_3" id="__nav_4_1_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Js
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8_3">
            <span class="md-nav__icon md-icon"></span>
            Js
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building OpenCV.js by Emscripten
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8_4" id="__nav_4_1_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Maven
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8_4">
            <span class="md-nav__icon md-icon"></span>
            Maven
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/maven/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Maven to build OpenCV
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8_5" id="__nav_4_1_8_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wince
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8_5">
            <span class="md-nav__icon md-icon"></span>
            Wince
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../platforms/wince/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building OpenCV from Source for Windows Embedded Compact (WINCE/WEC)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9" id="__nav_4_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Samples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9">
            <span class="md-nav__icon md-icon"></span>
            Samples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9_1" id="__nav_4_1_9_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9_1">
            <span class="md-nav__icon md-icon"></span>
            Dnn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../samples/dnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenCV deep learning module samples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9_1_2" id="__nav_4_1_9_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn model runner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_9_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9_1_2">
            <span class="md-nav__icon md-icon"></span>
            Dnn model runner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9_1_2_1" id="__nav_4_1_9_1_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dnn conversion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_1_9_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            Dnn conversion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9_1_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9_1_2_1_1" id="__nav_4_1_9_1_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Paddlepaddle
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_4_1_9_1_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9_1_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            Paddlepaddle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../samples/dnn/dnn_model_runner/dnn_conversion/paddlepaddle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run PaddlePaddle model using OpenCV
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9_2" id="__nav_4_1_9_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9_2">
            <span class="md-nav__icon md-icon"></span>
            Hal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../samples/hal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom HAL samples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9_3" id="__nav_4_1_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Semihosting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9_3">
            <span class="md-nav__icon md-icon"></span>
            Semihosting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../samples/semihosting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arm semihosting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Source docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Source docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../source_docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    source checking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Testcases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Testcases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../source_docs/testcases/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-a-custom-layer-in-c" class="md-nav__link">
    <span class="md-ellipsis">
      Define a custom layer in C++
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-custom-layer-from-caffe" class="md-nav__link">
    <span class="md-ellipsis">
      Example: custom layer from Caffe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-custom-layer-from-tensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      Example: custom layer from TensorFlow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-a-custom-layer-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Define a custom layer in Python
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="custom-deep-learning-layers-support-tutorial_dnn_custom_layers">Custom deep learning layers support {#tutorial_dnn_custom_layers}<a class="headerlink" href="#custom-deep-learning-layers-support-tutorial_dnn_custom_layers" title="Permanent link">&para;</a></h1>
<p>@tableofcontents</p>
<p>@prev_tutorial{tutorial_dnn_javascript}
@next_tutorial{tutorial_dnn_OCR}</p>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Original author</td>
<td style="text-align: left;">Dmitry Kurtaev</td>
</tr>
<tr>
<td style="text-align: right;">Compatibility</td>
<td style="text-align: left;">OpenCV &gt;= 3.4.1</td>
</tr>
</tbody>
</table>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Deep learning is a fast-growing area. New approaches to building neural networks
usually introduce new types of layers. These could be modifications of existing
ones or implementation of outstanding research ideas.</p>
<p>OpenCV allows importing and running networks from different deep learning frameworks.
There is a number of the most popular layers. However, you can face a problem that
your network cannot be imported using OpenCV because some layers of your network
can be not implemented in the deep learning engine of OpenCV.</p>
<p>The first solution is to create a feature request at https://github.com/opencv/opencv/issues
mentioning details such as a source of a model and a type of new layer.
The new layer could be implemented if the OpenCV community shares this need.</p>
<p>The second way is to define a <strong>custom layer</strong> so that OpenCV's deep learning engine
will know how to use it. This tutorial is dedicated to show you a process of deep
learning model's import customization.</p>
<h2 id="define-a-custom-layer-in-c">Define a custom layer in C++<a class="headerlink" href="#define-a-custom-layer-in-c" title="Permanent link">&para;</a></h2>
<p>Deep learning layer is a building block of network's pipeline.
It has connections to <strong>input blobs</strong> and produces results to <strong>output blobs</strong>.
There are trained <strong>weights</strong> and <strong>hyper-parameters</strong>.
Layers' names, types, weights and hyper-parameters are stored in files are
generated by native frameworks during training. If OpenCV encounters unknown
layer type it throws an exception while trying to read a model:</p>
<div class="highlight"><pre><span></span><code>Unspecified error: Can&#39;t create layer &quot;layer_name&quot; of type &quot;MyType&quot; in function getLayerInstance
</code></pre></div>
<p>To import the model correctly you have to derive a class from cv::dnn::Layer with
the following methods:</p>
<p>@snippet dnn/custom_layers.hpp A custom layer interface</p>
<p>And register it before the import:</p>
<p>@snippet dnn/custom_layers.hpp Register a custom layer</p>
<p>@note <code>MyType</code> is a type of unimplemented layer from the thrown exception.</p>
<p>Let's see what all the methods do:</p>
<ul>
<li>Constructor</li>
</ul>
<p>@snippet dnn/custom_layers.hpp MyLayer::MyLayer</p>
<p>Retrieves hyper-parameters from cv::dnn::LayerParams. If your layer has trainable
weights they will be already stored in the Layer's member cv::dnn::Layer::blobs.</p>
<ul>
<li>A static method <code>create</code></li>
</ul>
<p>@snippet dnn/custom_layers.hpp MyLayer::create</p>
<p>This method should create an instance of you layer and return cv::Ptr with it.</p>
<ul>
<li>Output blobs' shape computation</li>
</ul>
<p>@snippet dnn/custom_layers.hpp MyLayer::getMemoryShapes</p>
<p>Returns layer's output shapes depending on input shapes. You may request an extra
memory using <code>internals</code>.</p>
<ul>
<li>Run a layer</li>
</ul>
<p>@snippet dnn/custom_layers.hpp MyLayer::forward</p>
<p>Implement a layer's logic here. Compute outputs for given inputs.</p>
<p>@note OpenCV manages memory allocated for layers. In the most cases the same memory
can be reused between layers. So your <code>forward</code> implementation should not rely on that
the second invocation of <code>forward</code> will have the same data at <code>outputs</code> and <code>internals</code>.</p>
<ul>
<li>Optional <code>finalize</code> method</li>
</ul>
<p>@snippet dnn/custom_layers.hpp MyLayer::finalize</p>
<p>The chain of methods is the following: OpenCV deep learning engine calls <code>create</code>
method once, then it calls <code>getMemoryShapes</code> for every created layer, then you
can make some preparations depend on known input dimensions at cv::dnn::Layer::finalize.
After network was initialized only <code>forward</code> method is called for every network's input.</p>
<p>@note Varying input blobs' sizes such height, width or batch size make OpenCV
reallocate all the internal memory. That leads to efficiency gaps. Try to initialize
and deploy models using a fixed batch size and image's dimensions.</p>
<h2 id="example-custom-layer-from-caffe">Example: custom layer from Caffe<a class="headerlink" href="#example-custom-layer-from-caffe" title="Permanent link">&para;</a></h2>
<p>Let's create a custom layer <code>Interp</code> from https://github.com/cdmh/deeplab-public.
It's just a simple resize that takes an input blob of size <code>N x C x Hi x Wi</code> and returns
an output blob of size <code>N x C x Ho x Wo</code> where <code>N</code> is a batch size, <code>C</code> is a number of channels,
<code>Hi x Wi</code> and <code>Ho x Wo</code> are input and output <code>height x width</code> correspondingly.
This layer has no trainable weights but it has hyper-parameters to specify an output size.</p>
<p>In example,
<div class="highlight"><pre><span></span><code>layer {
  name: &quot;output&quot;
  type: &quot;Interp&quot;
  bottom: &quot;input&quot;
  top: &quot;output&quot;
  interp_param {
    height: 9
    width: 8
  }
}
</code></pre></div></p>
<p>This way our implementation can look like:</p>
<p>@snippet dnn/custom_layers.hpp InterpLayer</p>
<p>Next we need to register a new layer type and try to import the model.</p>
<p>@snippet dnn/custom_layers.hpp Register InterpLayer</p>
<h2 id="example-custom-layer-from-tensorflow">Example: custom layer from TensorFlow<a class="headerlink" href="#example-custom-layer-from-tensorflow" title="Permanent link">&para;</a></h2>
<p>This is an example of how to import a network with <a href="https://www.tensorflow.org/versions/master/api_docs/python/tf/image/resize_bilinear">tf.image.resize_bilinear</a>
operation. This is also a resize but with an implementation different from OpenCV's or <code>Interp</code> above.</p>
<p>Let's create a single layer network:
<div class="highlight"><pre><span></span><code><span class="n">inp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="n">resized</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize_bilinear</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;resize_bilinear&#39;</span><span class="p">)</span>
</code></pre></div>
OpenCV sees that TensorFlow's graph in the following way:</p>
<p><div class="highlight"><pre><span></span><code>node {
  name: &quot;input&quot;
  op: &quot;Placeholder&quot;
  attr {
    key: &quot;dtype&quot;
    value {
      type: DT_FLOAT
    }
  }
}
node {
  name: &quot;resize_bilinear/size&quot;
  op: &quot;Const&quot;
  attr {
    key: &quot;dtype&quot;
    value {
      type: DT_INT32
    }
  }
  attr {
    key: &quot;value&quot;
    value {
      tensor {
        dtype: DT_INT32
        tensor_shape {
          dim {
            size: 2
          }
        }
        tensor_content: &quot;\t\000\000\000\010\000\000\000&quot;
      }
    }
  }
}
node {
  name: &quot;resize_bilinear&quot;
  op: &quot;ResizeBilinear&quot;
  input: &quot;input:0&quot;
  input: &quot;resize_bilinear/size&quot;
  attr {
    key: &quot;T&quot;
    value {
      type: DT_FLOAT
    }
  }
  attr {
    key: &quot;align_corners&quot;
    value {
      b: false
    }
  }
}
library {
}
</code></pre></div>
Custom layers import from TensorFlow is designed to put all layer's <code>attr</code> into
cv::dnn::LayerParams but input <code>Const</code> blobs into cv::dnn::Layer::blobs.
In our case resize's output shape will be stored in layer's <code>blobs[0]</code>.</p>
<p>@snippet dnn/custom_layers.hpp ResizeBilinearLayer</p>
<p>Next we register a layer and try to import the model.</p>
<p>@snippet dnn/custom_layers.hpp Register ResizeBilinearLayer</p>
<h2 id="define-a-custom-layer-in-python">Define a custom layer in Python<a class="headerlink" href="#define-a-custom-layer-in-python" title="Permanent link">&para;</a></h2>
<p>The following example shows how to customize OpenCV's layers in Python.</p>
<p>Let's consider <a href="https://arxiv.org/abs/1504.06375">Holistically-Nested Edge Detection</a>
deep learning model. That was trained with one and only difference comparing to
a current version of <a href="http://caffe.berkeleyvision.org/">Caffe framework</a>. <code>Crop</code>
layers that receive two input blobs and crop the first one to match spatial dimensions
of the second one used to crop from the center. Nowadays Caffe's layer does it
from the top-left corner. So using the latest version of Caffe or OpenCV you will
get shifted results with filled borders.</p>
<p>Next we're going to replace OpenCV's <code>Crop</code> layer that makes top-left cropping by
a centric one.</p>
<ul>
<li>Create a class with <code>getMemoryShapes</code> and <code>forward</code> methods</li>
</ul>
<p>@snippet dnn/edge_detection.py CropLayer</p>
<p>@note Both methods should return lists.</p>
<ul>
<li>Register a new layer.</li>
</ul>
<p>@snippet dnn/edge_detection.py Register</p>
<p>That's it! We have replaced an implemented OpenCV's layer to a custom one.
You may find a full script in the <a href="https://github.com/opencv/opencv/tree/4.x/samples/dnn/edge_detection.py">source code</a>.</p>
<table border="0">
<tr>
<td>![](js_tutorials/js_assets/lena.jpg)</td>
<td>![](images/lena_hed.jpg)</td>
</tr>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../../../..", "features": [], "search": "../../../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>